name: Android CI

on:
  - pull_request

jobs:
  gradle:
    strategy:
      matrix:
        os: [ubuntu-latest, macos-latest, windows-latest]
    runs-on: ${{ matrix.os }}
    steps:
    - uses: actions/checkout@v1
    - uses: actions/setup-java@v1
      with:
        distribution: temurin
        java-version: 8

    - name: Setup Gradle
      uses: gradle/gradle-build-action@v2

    - name: Execute Gradle build
      run: ./gradlew build

  tests:
    name: Android tests
    runs-on: ubuntu-latest
    needs: gradle

    steps:
        - uses: actions/checkout@v1
          with:
              fetch-depth: 1

        - name: Set up Java 1.8
          uses: actions/setup-java@v1
          with:
              java-version: 1.8

        - name: Run android tests
          run: /gradlew test --stacktrace
